# User Stories и Use Cases

---

## [US-1.1] Перевод текста песни

**User Story:**  
Как пользователь, я вставляю текст песни и получаю построчный перевод, чтобы понимать содержание.


| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | MUST HAVE |
| **Область действия** | Веб-приложение → Раздел «Анализ песни» |
| **Акторы**        | Пользователь, Система (Backend + DeepSeek) |
| **Предусловия**   | Система работает, доступен API DeepSeek |
| **Основной сценарий** | 1. Пользователь вставляет японский текст.<br>2. Нажимает «Начать перевод».<br>3. Система отправляет текст в DeepSeek.<br>4. Получает перевод блоками.<br>5. Отображает оригинал и перевод в колонках. |
| **Альтернативы**  | A1: Текст не японский → сообщение «Не похоже на японский текст».<br>A2: Нет подключения к DeepSeek → «Сервис недоступен». |
| **Исключения**    | E1: Таймаут → повторная попытка, затем ошибка TIMEOUT_DEEPSEEK |
| **Постусловия**   | Перевод блоками отображён на экране |

**Acceptance Criteria:**
- При корректном японском входе приложение возвращает выровненные блоки (оригинал в соответствии с переводом).
- Время до первого блока ≤ 20 сек.

---

## [US-1.2] Подсветка соответствующих блоков

**User Story:**
Как пользователь, я навожу или кликаю на блок в оригинале и вижу подсветку соответствующего перевода, чтобы лучше ориентироваться.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | MUST HAVE |
| **Область действия** | UI интерфейса «Анализ песни» |
| **Акторы**        | Пользователь, Система |
| **Предусловия**   | На экране есть колонки «Оригинал» и «Перевод» |
| **Основной сценарий** | 1. Пользователь наводит курсор на строку «Оригинал».<br>2. Система подсвечивает соответствующий блок в «Переводе».<br>3. При клике подсветка фиксируется. |
| **Альтернативы**  | A1: Пользователь кликает на «Перевод» → подсвечивается «Оригинал». |
| **Исключения**    | E1: Несоответствие данных (например, пустой перевод) → подсветка не срабатывает. |
| **Постусловия**   | Пользователь видит визуальную связь между блоками |

**Acceptance Criteria:**
- Hover/клик в колонке «Оригинал» синхронно подсвечивает соответствующий блок в «Переводе».  

---

## [US-1.3] Получение комментариев к блоку

**User Story:**
Как пользователь, я выбираю блок текста и получаю комментарии (грамматика, кандзи, культура), чтобы глубже понять смысл.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | MUST HAVE |
| **Область действия** | Панель «Комментарии» |
| **Акторы**        | Пользователь, Система, DeepSeek |
| **Предусловия**   | Перевод блоков выполнен, songId сохранён |
| **Основной сценарий** | 1. Пользователь кликает на блок.<br>2. Система отправляет запрос `/api/explain`.<br>3. DeepSeek возвращает комментарии.<br>4. Система отображает их в панели. |
| **Альтернативы**  | A1: Пользователь выбирает другой блок → панель обновляется. |
| **Исключения**    | E1: Ошибка API → сообщение «Комментарий не удалось получить». |
| **Постусловия**   | Комментарии отображены пользователю |

**Acceptance Criteria:**
- Клик по блоку открывает (или обновляет) панель «Комментарии» с пояснениями и структурой (списки, таблицы, эмодзи).

---

## [US-1.4] Сохранение результата анализа  

**User Story:**
Как пользователь, я сохраняю результат анализа, чтобы вернуться к нему позже.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | SHOULD HAVE |
| **Область действия** | Локальный кабинет (IndexedDB/LocalStorage) |
| **Акторы**        | Пользователь, Система |
| **Предусловия**   | Анализ песни завершён |
| **Основной сценарий** | 1. Пользователь нажимает «Сохранить перевод».<br>2. Система предлагает название (авто или вручную).<br>3. Сохраняет данные в локальное хранилище.<br>4. Запись появляется в «Мои переводы». |
| **Альтернативы**  | A1: Пользователь меняет название перед сохранением. |
| **Исключения**    | E1: Ошибка доступа → «Не удалось сохранить перевод». |
| **Постусловия**   | Перевод доступен в списке «Мои переводы» |

**Acceptance Criteria:**
- Сохранённый перевод появляется в списке «Мои переводы».
- Перевод доступен офлайн (IndexedDB/LocalStorage).

---

## [US-1.5] Удаление сохранённого перевода

**User Story:**
Как пользователь, я удаляю сохранённый перевод, чтобы управлять своими данными.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | MUST HAVE |
| **Область действия** | Локальный кабинет |
| **Акторы**        | Пользователь, Система |
| **Предусловия**   | В списке есть сохранённые переводы |
| **Основной сценарий** | 1. Пользователь нажимает «Удалить».<br>2. Система показывает подтверждение.<br>3. Пользователь подтверждает.<br>4. Перевод удаляется. |
| **Альтернативы**  | A1: Пользователь отменяет удаление → запись остаётся. |
| **Исключения**    | E1: Ошибка удаления → «Не удалось удалить перевод». |
| **Постусловия**   | Перевод удалён из списка |

**Acceptance Criteria:**
- Модальное подтверждение удаления содержит точное название перевода.
- После «Да» запись исчезает из списка/БД.

---

## [US-1.6] Редактирование комментариев (Admin)

**User Story:**
Как админ, я редактирую комментарии демо-песен, чтобы повысить их качество.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | COULD HAVE |
| **Область действия** | Панель «Комментарии» (Admin Mode) |
| **Акторы**        | Администратор, Система |
| **Предусловия**   | Приложение работает в Admin Mode |
| **Основной сценарий** | 1. Админ открывает демо-песню.<br>2. Выбирает блок и панель «Комментарии».<br>3. Вносит изменения.<br>4. Сохраняет правки. |
| **Альтернативы**  | A1: Отмена правки → изменения не сохраняются. |
| **Исключения**    | E1: Ошибка сохранения → «Не удалось применить изменения». |
| **Постусловия**   | Обновлённые комментарии сохранены |

**Acceptance Criteria:**
- Админ может отредактировать текст комментариев в демо-песне.
- После сохранения правки доступны другим пользователям.

---

## [US-1.7] Просмотр демо-песен

**User Story:**
Как пользователь, я открываю одну из предзагруженных демо-песен, чтобы быстро оценить продукт.

| Поле              | Описание |
|-------------------|----------|
| **Приоритет**     | MUST HAVE |
| **Область действия** | Раздел «Демо-песни» |
| **Акторы**        | Пользователь, Система |
| **Предусловия**   | В системе есть 3 демо-песни |
| **Основной сценарий** | 1. Пользователь открывает «Демо-песни».<br>2. Система показывает список.<br>3. Пользователь выбирает песню.<br>4. Система открывает анализ. |
| **Альтернативы**  | A1: Пользователь возвращается к списку демо-песен. |
| **Исключения**    | E1: Ошибка чтения базы → «Не удалось загрузить песню». |
| **Постусловия**   | Демо-песня отображается в режиме анализа |

**Acceptance Criteria:**
- Пользователь видит список из 3 демо-песен.
- При выборе открывается полный анализ песни (оригинал, перевод, комментарии).
